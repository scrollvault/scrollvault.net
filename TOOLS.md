# TOOLS.md - ScrollVault Workspace Notes

## CRITICAL: File Hygiene

**NEVER write large files to the workspace root** (`/home/degenai/.openclaw/workspace/`). Every file there gets loaded into agent context. Large files cause "prompt too large" errors.

- Temporary artifacts (JSON, HTML, raw data): save to `drafts/` subdirectory or `/home/degenai/scrollvault/data/drafts/`
- Workspace root = small docs only (under 10KB)

## Site Info

- **URL:** https://scrollvault.net
- **Staging:** https://staging.scrollvault.net
- **Build script:** `/home/degenai/scrollvault/build.js`
- **Data:** `/home/degenai/scrollvault/data/posts.json`
- **Stylesheet:** `/home/degenai/scrollvault/style.css`

## Pipeline

6-step agent pipeline: Scout → Writer → Editor → Fact Checker → Publisher → QA

```bash
# Full pipeline
bash /home/degenai/scrollvault/pipeline.sh

# Dry run (scout only)
bash /home/degenai/scrollvault/pipeline.sh --dry-run

# Rebuild site
node /home/degenai/scrollvault/build.js

# Build to staging
node /home/degenai/scrollvault/build.js --staging
```

## Agent Prompts

Located in `/home/degenai/scrollvault/agents/`:
scout.txt, writer.txt, editor.txt, factchecker.txt, publisher.txt, designer.txt, qa.txt, automation.txt, heartbeat.txt, data-analyst.txt, seo-optimizer.txt

## CRITICAL: Immutable Protected Files

The following files are **filesystem-locked with `chattr +i`** (immutable flag). They CANNOT be written to, moved, or deleted — even by root — without first running `bash /home/degenai/scrollvault/protect.sh unlock`.

**YOU MUST NEVER attempt to overwrite, modify, or recreate these files.** They contain SEO-optimized content that is actively ranking in Google. Overwriting them destroys keyword rankings.

Protected files:
- `build.js` — Site build script (SEO, canonical tags, schemas)
- `.htaccess` — Redirect rules, caching, security headers
- `pipeline.sh` — Agent pipeline script
- `tools/index.html` — Tools Hub
- `tools/manabase/index.html` — Mana Base Calculator
- `tools/lands/index.html` — Dual Lands Reference
- `tools/hypergeometric/index.html` — Hypergeometric Calculator
- `tools/hand-simulator/index.html` — Opening Hand Simulator
- `tools/price-checker/index.html` — Deck Price Checker
- `tools/commander-bracket/index.html` — Commander Bracket Calculator
- `tools/sealed/index.html` — Sealed Pool Simulator
- `decks/index.html` — Top Decks hub
- `draft/index.html` — Draft Simulator

These are hand-crafted pages NOT generated by build.js. Any write attempt will fail with "Permission denied" — this is intentional.

**What you CAN do:** Add new posts to `data/posts.json` and run `node build.js` to generate new article pages. The pipeline creates new content; it never touches protected files.

## File Ownership

All files under `/home/degenai/scrollvault/` must be `degenai:nobody` (Apache runs as nobody).
```bash
chown -R degenai:nobody /home/degenai/scrollvault/ 2>/dev/null || true
```

## Google Search Console

Query Google Search Console data for ScrollVault. Requires no auth setup — tokens are pre-configured.

```bash
# Last 7 days overview (clicks, impressions, CTR, position)
bash /home/degenai/scrollvault/scripts/gsc-query.sh

# Last N days
bash /home/degenai/scrollvault/scripts/gsc-query.sh 28

# Top pages by impressions
bash /home/degenai/scrollvault/scripts/gsc-query.sh pages 28

# Top search queries
bash /home/degenai/scrollvault/scripts/gsc-query.sh queries 28

# Sitemap/index status
bash /home/degenai/scrollvault/scripts/gsc-query.sh indexed

# Inspect a specific URL (crawl status, indexing, mobile usability)
bash /home/degenai/scrollvault/scripts/gsc-query.sh inspect https://scrollvault.net/posts/some-article.html
```

## Logs

- Pipeline logs: `/home/degenai/scrollvault/logs/pipeline-*.log`
- Gateway log: `/tmp/openclaw-gateway.log`
