# php -- BEGIN cPanel-generated handler, do not edit
# Set the "ea-php83" package as the default "PHP" programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php83 .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit

# Disable MultiViews to prevent 406 Not Acceptable errors
Options -MultiViews

<IfModule mod_rewrite.c>
RewriteEngine On

# Force HTTPS
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Force canonical host (non-www version)
RewriteCond %{HTTP_HOST} ^www\.scrollvault\.net$ [NC]
RewriteRule ^(.*)$ https://scrollvault.net/$1 [L,R=301]

# Remove trailing slash for .html files (prevents 404 on about.html/)
RewriteCond %{THE_REQUEST} \s/+(.+?\.html)/
RewriteRule ^ /%1 [R=301,L]

</IfModule>

# ── GZIP COMPRESSION ──
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/css text/javascript application/javascript
  AddOutputFilterByType DEFLATE application/json application/xml text/xml image/svg+xml
  AddOutputFilterByType DEFLATE application/rss+xml application/atom+xml
</IfModule>

# ── BROWSER CACHING ──
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 1 hour"

  # HTML - short cache (content changes frequently)
  ExpiresByType text/html "access plus 1 hour"

  # CSS & JS - medium cache
  ExpiresByType text/css "access plus 1 week"
  ExpiresByType application/javascript "access plus 1 week"
  ExpiresByType text/javascript "access plus 1 week"

  # Images & fonts - long cache
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/x-icon "access plus 1 year"
  ExpiresByType font/woff2 "access plus 1 year"
  ExpiresByType font/woff "access plus 1 year"
  ExpiresByType application/font-woff2 "access plus 1 year"

  # XML/JSON - short cache
  ExpiresByType application/json "access plus 1 hour"
  ExpiresByType application/xml "access plus 1 hour"
  ExpiresByType text/xml "access plus 1 hour"
</IfModule>

# Cache-Control headers (fallback / override)
<IfModule mod_headers.c>
  # HTML
  <FilesMatch "\.(html|htm)$">
    Header set Cache-Control "public, max-age=3600"
  </FilesMatch>

  # CSS & JS
  <FilesMatch "\.(css|js)$">
    Header set Cache-Control "public, max-age=604800"
  </FilesMatch>

  # Images & fonts
  <FilesMatch "\.(jpg|jpeg|png|gif|svg|webp|ico|woff|woff2)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>

  # Sitemap & feeds
  <FilesMatch "\.(xml)$">
    Header set Cache-Control "public, max-age=3600"
  </FilesMatch>
</IfModule>
